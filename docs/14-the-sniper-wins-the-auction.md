# 14. The Sniper Wins the Auction

## First, a Failing Test

![A sniper bids, then wins](https://www.safaribooksonline.com/library/view/growing-object-oriented-software/9780321574442/graphics/14fig01.jpg "A sniper bids, then wins")

------------------------------------------------------------------------------------------------------------------------
![](https://www.safaribooksonline.com/library/view/growing-object-oriented-software/9780321574442/graphics/140pro01.jpg)

------------------------------------------------------------------------------------------------------------------------
![](https://www.safaribooksonline.com/library/view/growing-object-oriented-software/9780321574442/graphics/140pro02.jpg)

------------------------------------------------------------------------------------------------------------------------

## Who Knows about Bidders?

------------------------------------------------------------------------------------------------------------------------
![](https://www.safaribooksonline.com/library/view/growing-object-oriented-software/9780321574442/graphics/141pro01.jpg)

------------------------------------------------------------------------------------------------------------------------
![](https://www.safaribooksonline.com/library/view/growing-object-oriented-software/9780321574442/graphics/141pro02.jpg)

------------------------------------------------------------------------------------------------------------------------
#### The new test fails:

![](https://www.safaribooksonline.com/library/view/growing-object-oriented-software/9780321574442/graphics/142pro01.jpg)

------------------------------------------------------------------------------------------------------------------------
#### The fix is to compare the Sniper identifier to the bidder from the event message:

![](https://www.safaribooksonline.com/library/view/growing-object-oriented-software/9780321574442/graphics/142pro02.jpg)

------------------------------------------------------------------------------------------------------------------------
![](https://www.safaribooksonline.com/library/view/growing-object-oriented-software/9780321574442/graphics/142pro03.jpg)

------------------------------------------------------------------------------------------------------------------------

## The Sniper Has More to Say

------------------------------------------------------------------------------------------------------------------------
![](https://www.safaribooksonline.com/library/view/growing-object-oriented-software/9780321574442/graphics/143pro01.jpg)

------------------------------------------------------------------------------------------------------------------------
#### The test fails:

![](https://www.safaribooksonline.com/library/view/growing-object-oriented-software/9780321574442/graphics/143pro02.jpg)

------------------------------------------------------------------------------------------------------------------------
#### The fix is straightforward:

![](https://www.safaribooksonline.com/library/view/growing-object-oriented-software/9780321574442/graphics/143pro03.jpg)

------------------------------------------------------------------------------------------------------------------------
![](https://www.safaribooksonline.com/library/view/growing-object-oriented-software/9780321574442/graphics/144pro01.jpg)

------------------------------------------------------------------------------------------------------------------------

## The Sniper Acquires Some State

![A Sniper bids, then loses](https://www.safaribooksonline.com/library/view/growing-object-oriented-software/9780321574442/graphics/14fig02.jpg "A Sniper bids, then loses")

------------------------------------------------------------------------------------------------------------------------
![](https://www.safaribooksonline.com/library/view/growing-object-oriented-software/9780321574442/graphics/145pro01.jpg)

------------------------------------------------------------------------------------------------------------------------

## The Sniper Wins

------------------------------------------------------------------------------------------------------------------------
![](https://www.safaribooksonline.com/library/view/growing-object-oriented-software/9780321574442/graphics/147pro01.jpg)

------------------------------------------------------------------------------------------------------------------------
![](https://www.safaribooksonline.com/library/view/growing-object-oriented-software/9780321574442/graphics/147pro02.jpg)

------------------------------------------------------------------------------------------------------------------------
![](https://www.safaribooksonline.com/library/view/growing-object-oriented-software/9780321574442/graphics/147pro03.jpg)

------------------------------------------------------------------------------------------------------------------------

![The Sniper wins](https://www.safaribooksonline.com/library/view/growing-object-oriented-software/9780321574442/graphics/14fig03.jpg "The Sniper wins")

## Making Steady Progress
